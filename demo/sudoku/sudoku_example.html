<!DOCTYPE html>
<head>
<title>Jalog Sudoku Example</title>
<style>
.a1 {
  font-family: serif;
  font-style: italic;
}
</style>
</head>
<body>

<h1>Jalog Sudoku Example</h1>

<p><em>Sudoku solver example written in Jalog and Java</em></p>
<p>This example demonstrates how to use Jalog and Java language together.
In this example the Sudoku solving algorithm is implemented using Jalog. Java
is used to specify the Sudoku problem and to display the solution.</p>

<h3>Authors</h3>

<p>Mikko Levanto, Ari Okkonen</p>


<h2>Installation</h2>

<h2>Structure</h2>

The Java part is in the file <code>SolveSudoku.java</code>. 
The Jalog part is in the file <code>sudoku_solver_component.pro</code>.

<h3>Java part</h3>

The inference engine is initialized to the object variable <code>myJalog</code>. The <code>main</code>
method loads the Jalog program, prints the problem, solves the problem using
Jalog code, and prints the result. Finally the Jalog program is purged from
memory.

The method <code>print_sudoku</code> formats the Sudoku data to display.

<h4>Preparation of the problem</h4>

The method <code>solve_sudoku</code> converts the problem data to 
<code>Jalog.Term</code> data structure suitable for processing by Jalog.
In nested loops the the two dimensional Java array of integers is converted to 
a Jalog list of lists of integers. Each Jalog integer is created with 
the <code>Jalog.integer</code> method. The <code>Jalog.open</code> method is
used to create empty positions that are later filled by the solution 
algorithm. The lists are created using the <code>Jalog.list</code> method.
The prepared problem is in the variable <code>board</code>.

<pre>
    for (i = 0; i < 9; i++) {
      for (j = 0; j < 9; j++) {
        value = sudoku_problem[i][j];
        if(value == 0) {
          line[j] = Jalog.open();
        } else {
          line[j] = Jalog.integer(sudoku_problem[i][j]);
        }
      }
      matrix[i] = Jalog.list(line);
    }
    board = Jalog.list(matrix);
</pre>
<h4>Finding the solution</h4>

The solution algorithm is called as a condition of an if statement. In addition the if-structure is surrounded a try-catch structure. The reason is that an execution of Jalog code can result success, failure, or an exception. In case of success the 
<code>call</code> method returns <code>true</code>. In case of failure the
<code>call</code> method returns <code>false</code>. In case of exception the
<code>call</code> method throws <code>Jalog.Exit</code>.
<pre>
    try {
      if (myJalog.call("sudoku", board))
      {
        <span class="a1">Getting the solution</span>
      } else { // fail
        <span class="a1">Report solution not found</span>
      }
    } catch (Jalog.Exit e) {
      <span class="a1">Report exception</span>
    }
</pre>
The call of the solution algorithm in the if clause. The <code>call</code> method of the instantiated engine is called with the predicate name and the prepared parameter.

<h4>Getting the solution</h4>

In the <code>true</code> branch of the if statement the result is transferred
from <code>board</code> to Java variable <code>sudoku_solution</code> in nested
loops. The lists are converted to Java arrays using <code>getElements</code>
method. The type of elements is checked using <code>getType</code> method.
Integers are converted to Java <code>long</code> values using the 
<code>getIntegerValue</code> method and then typecasted to <code>int</code>.

<pre>
        matrix = board.getElements();
        for (i = 0; i &lt; 9; i++) {
          line = matrix[i].getElements();
          for (j = 0; j &lt; 9; j++) {
            element = line[j];
            if (element.getType() == Jalog.INTEGER) {
              sudoku_solution[i][j] = (int)element.getIntegerValue();
            } else {
              sudoku_solution[i][j] = 0; // error in algorithm
            }
          }
        }
</pre>
If the solution contains zeros, there is an apparent error in the algorithm.
<h4>Report solution not found</h4>
This is executed, if no solution is found. This is indicated by copying the unsolved problem to the solution variable.
<pre>
        for (i = 0; i &lt; 9; i++) {
          for (j = 0; j &lt; 9; j++) {
            sudoku_solution[i][j] = sudoku_problem[i][j];
          }
        }
</pre>
<h4>Report exception</h4>
This is executed, if an exception is encountered. This is indicated by filling the solution variable with zeros.
<pre>
      for (i = 0; i &lt; 9; i++) {
        for (j = 0; j &lt; 9; j++) {
          sudoku_solution[i][j] = 0;
        }
      }
</pre>





<h3>Jalog part</h3>

<img src="predicate_hierarchy.svg" width="100%" style="max-width:1000px"/>





<h2>Download</h2>
<p>In order to use Jalog you need <a href="https://www.oracle.com/technetwork/java/javase/downloads/index.html">Java runtime environment (JRE)</a>.</p>
<p>Get Jalog interpreter: <a href="jalog.jar">Download JAR</a></p>
<h2>Usage</h2>
<h3>Stand-alone Jalog</h3>
<pre>
X:><b>java -jar jalog.jar</b> <i>Parameters</i>
<i>Parameters</i>: &lt;compiler_options> &lt;program_name> &lt;program_arguments>
  &lt;compiler_options>
      -v Show version information
  &lt;program_name> - complete file name - no default extensions
  &lt;program_arguments> - as the program needs them
</pre>
<h3>Integrated Jalog</h3>
<p>A Jalog program can be called from a Java program. The purpose of this arrangement is to facilitate using Java for the input and output including the user interface, and the Prolog like language for problem solving and planning purposes.</p>
<p><a href="Jalog_class_doc.html">Interface documentation</a></p>
  <h2>Intended use</h2>
<p>Jalog gives ability to use <a href="https://en.wikipedia.org/wiki/Prolog">Prolog</a> style reasoning whereever <a href="https://en.wikipedia.org/wiki/Java_%28programming_language%29">Java</a> can be used. Prolog helps the programmer to concentrate on the problem instead of the solution algorithm. Examples: finding routes, solving puzzles like Sudoku, ...</p>
<p>See examples in <a href="https://github.com/JalogTeam/Jalog/tree/master/test"><code>test</code></a> directory for implemented features.</p>
<hr />
<h3>Version history</h3>
<p><strong>0.4</strong> 2019-08-06 Build system for jar file: build_jar.bat.</p>
<p><strong>0.3</strong> 2019-07-24 Interface test completed and integrated to regression test.</p>
<p><strong>0.2</strong> 2012-04-20 Minor corrections. Debug timing disabled.</p>
<p><strong>0.1</strong> 2012-03-13 Initial version. Capable of solving Sudoku.</p>
</body>
</html>
